\chapter{Stochastic and Deterministic Processes}

\begin{refsection}

\section{Stochastic Processes}

\begin{itemize}
	\item Stochastic processes $\rightarrow$ random signal
	\item No deterministic description
	\item Description of random parameters (probability, ...)
\end{itemize}

\subsection{Statistic Mean}

Given is family of curves $\vect{x}(t) = \left\{x_1(t), x_2(t), \dots, x_n(t)\right\}$. $\vect{x}(t)$ is called a \index{random vector} \textbf{random vector}.

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			height={0.25\textheight},
			width=0.6\linewidth,
			scale only axis,
			xlabel={$t$},
			ylabel={$x(t)$},
			%grid style={line width=.6pt, color=lightgray},
			%grid=both,
			grid=none,
			legend pos=north east,
			axis y line=middle,
			axis x line=middle,
			every axis x label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=north,
			},
			every axis y label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=east,
			},
			xmin=0,
			xmax=11,
			ymin=0,
			ymax=1.7,
			xtick={0, 1, ..., 10},
			ytick={0, 0.5, ..., 1.5},
			xticklabels={0, 1, $t_0$, 3, 4, ..., 10}
		]
			\addplot[black, dashed, smooth, domain=1:10, samples=200] plot (\x,{1.5*abs(sinc((1/(2*pi))*\x))});
			\pgfmathsetseed{100}
			\addplot[red, smooth, domain=1:10, samples=50] plot (\x,{1.5*abs(sinc((1/(2*pi))*\x)) + 0.1*rand});
			\addlegendentry{$x_1$};
			\pgfmathsetseed{200}
			\addplot[blue, smooth, domain=1:10, samples=50] plot (\x,{1.5*abs(sinc((1/(2*pi))*\x)) + 0.1*rand});
			\addlegendentry{$x_2$};
			\pgfmathsetseed{300}
			\addplot[green, smooth, domain=1:10, samples=50] plot (\x,{1.5*abs(sinc((1/(2*pi))*\x)) + 0.1*rand});
			\addlegendentry{$x_3$};
			\addplot[black, very thick, dashed] coordinates {(2,0) (2,2.2)};
		\end{axis}
	\end{tikzpicture}
	\caption{Family of random signals}
\end{figure}

\begin{itemize}
	\item The curves are produced by a random process $\vect{x}(t)$. The random process is time-dependent.
	\item All curves consist of random values, which are gathered around a mean value $\E\left\{\vect{x}(t)\right\}$.
	\item The random process can emit any value $x$. However, each value $x$ has a certain likelihood $p(x, t)$ of being produced. Again, this likelihood is time-dependent like the stochastic process.
\end{itemize}

Let's assume that the values are normally distributed. The \index{probability density function} \textbf{\ac{PDF}} $p(x, t)$ of a \index{normal distribution} \textbf{normal distribution} is:
\begin{equation}
	p(x, t) = \frac{1}{\sigma(t) \sqrt{2 \pi}} e^{-\frac{1}{2} \left(\frac{x - \mu(t)}{\sigma(t)}\right)^2}
\end{equation}
$p(x, t)$ is the likelihood that the stochastic process emits the value $x$ at time instance $t$. Both the mean of the normal distribution $\mu(t)$ and the standard deviation of the normal distribution $\sigma(t)$ are time-dependent.

\begin{attention}
	Do not confuse the mean of the normal distribution $\mu$ and the mean of a series of samples $\E\left\{\cdot\right\}$ (expectation value)!
\end{attention}

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			height={0.25\textheight},
			width=0.8\linewidth,
			scale only axis,
			xlabel={$x$},
			ylabel={$p(x, t_0)$},
			%grid style={line width=.6pt, color=lightgray},
			%grid=both,
			grid=none,
			legend pos=north east,
			axis y line=middle,
			axis x line=middle,
			every axis x label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=north,
			},
			every axis y label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=east,
			},
			xmin=-1.2,
			xmax=4.2,
			ymin=0,
			ymax=1.2,
			xtick={-1, 0, 1, 1.47, 2, 3, 4},
			ytick={0, 0.5, ..., 2.0},
			xticklabels={-1, 0, 1, $\E\left\{\vect{x}(t_0)\right\}$, 2, 3, 4}
		]
			% Âµ = 1.47, simga = 0.5
			\addplot[red, thick, smooth, domain=, samples=200] plot (\x, {(1/(0.5*sqrt(2*pi)))*exp(-0.5*((\x-1.47)/0.5)^2)});
			
			\addplot[black, very thick, dashed] coordinates {(1.47,0) (1.47,1)};
		\end{axis}
	\end{tikzpicture}
	\caption{Probability density function for an output value of a stochastic process at time $t_0$ with $\mu(t_0) = 1.47$ and $\sigma(t_0) = 0.5$}
\end{figure}

Given that
\begin{itemize}
	\item We know neither the mean of the normal distribution $\mu(t)$ nor the standard deviation of the normal distribution $\sigma(t)$.
	\item We only have $n$ samples of the curves $x_i(t_0)$ ($i \in \mathbb{N}, 0 \leq i \leq n$) at the time instance $t_0$.
	\item We do know that the random distribution of our samples $x_i(t_0)$ follows the \ac{PDF} $p(x, t_0)$.
\end{itemize}

\paragraph{How do we get the mean of out samples $\E\left\{X(t_0)\right\}$? (Finite case)}

The mean of the samples is the \index{expectation value} \textbf{expectation value} $\E\left\{\vect{x}(t_0)\right\}$. \nomenclature[Se]{$\E\left\{\cdot\right\}$}{Expectation value}

To get an approximation, we can calculate the \index{arithmetic mean} \textbf{arithmetic mean} of out $n$ samples:
\begin{equation}
	\E\left\{\vect{x}(t_0)\right\} \approx \frac{1}{n} \sum\limits_{i = 0}^{n} x_i(t_0)
	\label{eq:ch03:arith_mean}
\end{equation}
The approximation converges to the real $\E\left\{\vect{x}(t_0)\right\}$ for $n \rightarrow \infty$, because the random distribution of our samples $x_i(t_0)$ follows the \ac{PDF} $p(x, t_0)$.

\paragraph{What about an arbitrary \ac{PDF}? (Continuous case)}

\begin{itemize}
	\item We cannot collect an indefinite number of samples.
	\item However, if the \ac{PDF} is known, we can calculate the mean of our samples.
\end{itemize}

Extending, the arithmetic mean \eqref{eq:ch03:arith_mean}, with $n \rightarrow \infty$ and using all $x$ but weighted by their \ac{PDF} $p(x, t_0)$, we can determine the expectation value.
\begin{definition}{Stochastic mean}
	The \index{stochastic mean} \textbf{stochastic mean} of a \ac{PDF} is:
	\begin{equation}
		\E\left\{\vect{x}(t_0)\right\} = \int\limits_{-\infty}^{\infty} x \cdot p(x, t_0) \; \mathrm{d} x
	\end{equation}%
	\nomenclature[Se]{$\E\left\{\vect{x}\right\}$}{Stochastic mean}
\end{definition}

\begin{fact}
	In general, stochastic means are time-dependent.
\end{fact}

\paragraph{Other measures?}

The \index{quadratic stochastic mean} \textbf{quadratic stochastic mean}:
\begin{equation}
	\E\left\{\vect{x}^2(t_0)\right\} = \int\limits_{-\infty}^{\infty} x^2 \cdot p(x, t_0) \; \mathrm{d} x
\end{equation}

\subsection{Temporal Mean}

Given is a random time-domain signal $x_i(t)$ (where $i \in \mathbb{N}$ an arbitrary integer index):

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			height={0.25\textheight},
			width=0.6\linewidth,
			scale only axis,
			xlabel={$t$},
			ylabel={$x_i(t)$},
			%grid style={line width=.6pt, color=lightgray},
			%grid=both,
			grid=none,
			legend pos=north east,
			axis y line=middle,
			axis x line=middle,
			every axis x label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=north,
			},
			every axis y label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=east,
			},
			xmin=-5.5,
			xmax=5.5,
			ymin=0,
			ymax=3.2,
			xtick={-5, -4, ..., 5},
			ytick={0, 1, ..., 3},
			xticklabels={-5, -4, -3, -2, $-\frac{T}{2}$, 0, $\frac{T}{2}$, 2, 3, 4, 5}
		]
			\pgfmathsetseed{100}
			\addplot[red, smooth, domain=-5:5, samples=50] plot (\x,{1.5 + 0.8*rand});
			\addplot[black, thick, dashed] coordinates {(-1,0) (-1,3.2)};
			\addplot[black, thick, dashed] coordinates {(1,0) (1,3.2)};
			\addplot[black, dashed] coordinates {(-5,1.5) (5,1.5)};
		\end{axis}
	\end{tikzpicture}
	\caption{Random time-domain signal}
\end{figure}

\textit{Remark:} The signal can be a sample of a family of signals, but it is not required to be.

The temporal mean is calculated as the arithmetic mean with following differences to \eqref{eq:ch03:arith_mean}:
\begin{itemize}
	\item The mean is calculation over the time, not over a number of samples.
	\item For a time-continuous signal, the sum extends to an integral.
	\item The arithmetic mean is calculated over the time interval $[-\frac{T}{2}, \frac{T}{2}]$. Let's make the interval indefinite.
\end{itemize}

\begin{definition}{Temporal mean}
	The \index{temporal mean} \textbf{temporal mean} of time-domain signal $x_i(t)$ is:
	\begin{equation}
		\overline{x_i} = \E\left\{x_i(t)\right\} = \lim\limits_{T \rightarrow \infty} \frac{1}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} x_i{t} \; \mathrm{d} t
	\end{equation}%
	\nomenclature[Sx]{$\overline{x}$, $\E\left\{x_i(t)\right\}$}{Temporal mean of x}
\end{definition}

The temporal mean is not time-dependent.

\begin{fact}
	In general, temporal means are sample-dependent.
\end{fact}

Actually $x_i(t)$ would not need the index $i$ if there is only one sample. Nevertheless, it was kept here, to emphasize the dependency on the sample, in contrast to the dependency on the time of the stochastic mean.

\begin{attention}
	The complex conjugate uses the same notation as the temporal mean. You need to guess it from the context. The complex conjugate is only used in conjunction with complex number which can be identified by their underline.
\end{attention}

\paragraph{Other measures?}

The \index{quadratic temporal mean} \textbf{quadratic temporal mean}:
\begin{equation}
	\overline{x^2_i} = \E\left\{x^2_i(t)\right\} = \lim\limits_{T \rightarrow \infty} \frac{1}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} |x_i{t}|^2 \; \mathrm{d} t
\end{equation}

\subsection{Ergodic Processes}

\begin{definition}{Ergodic process}
	\index{ergodic process} A process is \textbf{ergodic} if:
	\begin{enumerate}
		\item The stochastic means are equal at all times.
		\begin{equation}
			\E\left\{\vect{x}(t_0)\right\} = \E\left\{\vect{x}(t_1)\right\} = \dots = \E\left\{\vect{x}\right\}
		\end{equation}
		\item The temporal means of all samples are equal.
		\begin{equation}
			\overline{x_1} = \overline{x_2} = \dots = \overline{x}
		\end{equation}
		\item The stochastic mean equals the temporal mean.
		\begin{equation}
			\E\left\{\vect{x}\right\} = \overline{x} = \mu_x
		\end{equation}
	\end{enumerate}
\end{definition}

As a consequence:
\begin{itemize}
	\item One single, sufficiently long, random sample of the process is enough to deduct the statistical properties of an ergodic process.
	\item The ergodic process is in steady state (\index{wide sense stationary}\ac{WSS}), i.e., it does not erratically change its behaviour and properties.
\end{itemize}

\begin{figure}[H]
	\centering
		\begin{tikzpicture}
			\begin{axis}[
			height={0.25\textheight},
			width=0.6\linewidth,
			scale only axis,
			xlabel={$t$},
			ylabel={$x_i(t)$},
			%grid style={line width=.6pt, color=lightgray},
			%grid=both,
			grid=none,
			legend pos=north east,
			axis y line=middle,
			axis x line=middle,
			every axis x label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=north,
			},
			every axis y label/.style={
				at={(ticklabel* cs:1.05)},
				anchor=east,
			},
			xmin=-5.5,
			xmax=5.5,
			ymin=0,
			ymax=3.2,
			xtick={-5, -4, ..., 5},
			ytick={0, 1, ..., 3},
			xticklabels={-5, -4, -3, -2, $-\frac{T}{2}$, 0, $\frac{T}{2}$, 2, 3, 4, 5}
			]
			\pgfmathsetseed{100}
			\addplot[red, smooth, domain=-5:5, samples=50] plot (\x,{1.5 + 0.8*rand});
			\addlegendentry{$x_1$};
			\pgfmathsetseed{200}
			\addplot[blue, smooth, domain=-5:5, samples=50] plot (\x,{1.5 + 0.8*rand});
			\addlegendentry{$x_2$};
			\pgfmathsetseed{300}
			\addplot[green, smooth, domain=-5:5, samples=50] plot (\x,{1.5 + 0.8*rand});
			\addlegendentry{$x_3$};
			\addplot[black, dashed] coordinates {(-5,1.5) (5,1.5)};
			\addlegendentry{$\mu_x$};
		\end{axis}
		\end{tikzpicture}
	\caption{Three samples of the same ergodic process}
\end{figure}

\subsection{Cross-Correlation}

\begin{itemize}
	\item Imagine you have two random processes.
	\item They produce the (complex) random vectors $\cmplxvect{x}(t)$ and $\cmplxvect{y}(t)$.
	\item The random processes can be somehow related (correlated) to each other. But they can also be independent instead.
	\item How can we find this out?
\end{itemize}

We need a similarity measure. The cross-correlation is such a measure.

\begin{definition}{Cross-correlation of stochastic processes}
	The \index{cross-correlation!stochastic process} \text{cross-correlation of two stochastic processes} $\cmplxvect{x}(t_1)$ and $\cmplxvect{y}(t_2)$ between the times $t_1$ and $t_2$ is:
	\begin{equation}
		\underline{\mathrm{R}}_{XY}(t_1, t_2) = \E\left\{ \cmplxvect{x}(t_1) \overline{\cmplxvect{y}(t_2)} \right\}
	\end{equation}%
	\nomenclature[Sr]{$\mathrm{R}_{XY}$}{Cross-correlation of two random vectors}
	where $\overline{\left(\cdot\right)}$ denotes the complex conjugate.
\end{definition}

The expectation value can be expressed for real values as:
\begin{equation}
	\mathrm{R}_{XY}(t_1, t_2) = \E\left\{ \vect{x}(t_1) \vect{y}(t_2) \right\} = \int\limits_{y = -\infty}^{\infty} \int\limits_{x = -\infty}^{\infty} x y \cdot p(x, y, t_1, t_2) \; \mathrm{d} x \mathrm{d} y
\end{equation}
$p(x, y, t_1, t_2)$ is the joint \ac{PDF} of the two random processes. It defines the likelihood that $x$ is produced at time $t_1$ \textbf{and} $y$ is produced at time $t_2$.

Let's derive a special case for \textbf{ergodic} or \ac{WSS} processes:
\begin{itemize}
	\item The time difference is $\tau = t_2 - t_1$.
	\item Because of the ergodicity of the two processes, only one sample of each $x_i(t)$ and $y_i(t)$ needs to be taken.
	\item An estimation for the cross-correlation is averaging the products of the time-shifted samples $x_i(t) \cdot y_i(t+\tau)$. This resembles
\end{itemize}
Extending this to complex numbers yields:
\begin{equation}
	\underline{\mathrm{R}}_{XY}(\tau) = \E\left\{ \cmplxvect{x}(t) \overline{\cmplxvect{y}(t+\tau)} \right\} \approx \lim\limits_{T \rightarrow \infty} \frac{1}{T} \int\limits_{t = -\frac{T}{2}}^{\frac{T}{2}} \underline{x}_i(t) \cdot \overline{\underline{y}_i(t+\tau)} \; \mathrm{d} t
\end{equation}

This resembles the cross-correlation of deterministic signals
\begin{definition}{Cross-correlation of deterministic signals}
	The \index{cross-correlation!deterministic signals} \text{cross-correlation of two deterministic signals} $\underline{f}(t_1)$ and $\underline{g}(t_2)$ between the times $\tau = t_2 - t_1$ is:
	\begin{equation}
		\left(\underline{f} \star \underline{g}\right)(\tau) = \int\limits_{t = -\infty}^{\infty} \underline{f}(t) \cdot \overline{\underline{g}(t+\tau)} \; \mathrm{d} t
	\end{equation}%
	\nomenclature[N]{$\left(f \ast g\right)(\tau)$}{Cross-correlation of two signals}
\end{definition}

\begin{attention}
	You must not confuse the operators for the convolution $*$ and correlation $\star$.
\end{attention}

For the random signals $\underline{x}(t)$ and $\underline{y}(t)$, the cross-correlation can not be determined analytically, but numerically.
\begin{equation}
	\underline{\mathrm{R}}_{XY}(\tau) \approx \left(\underline{x} \star \underline{y}\right)(\tau)
\end{equation}

\paragraph{What's the purpose?}

\begin{itemize}
	\item The cross-correlation ``scans'' the two signals for common features.
	\item The cross-correlation $\underline{\mathrm{R}}_{XY}(\tau)$ will show a peak at the time lag $\tau$, if
	\begin{itemize}
		\item The signals are correlated, i.e., have a common feature.
		\item The common feature is time-shifted by $\tau$.
	\end{itemize}
	\item A flat near $0$ cross-correlation means that the signals are uncorrelated.
\end{itemize}

\section{Spectral Density}

\subsection{Autocorrelation}

The autocorrelation is the correlation $\underline{\mathrm{R}}_{XX}(t_1, t_2)$ of a stochastic process $\cmplxvect{x}(t)$ with a time-shifted copy of itself.
\begin{equation}
	\underline{\mathrm{R}}_{XX}(t_1, t_2) = \E\left\{ \cmplxvect{x}(t_1) \overline{\cmplxvect{x}(t_2)} \right\}
\end{equation}

For \textbf{ergodic} or \ac{WSS} processes, the autocorrelation $\underline{\mathrm{R}}_{XX}(\tau)$ is the correlation of a signal $\underline{x}(t)$ with a time-shifted copy of itself:
\begin{equation}
	\underline{\mathrm{R}}_{XX}(\tau) = \E\left\{ \cmplxvect{x}(t) \overline{\cmplxvect{x}(t+\tau)} \right\} \approx \lim\limits_{T \rightarrow \infty} \frac{1}{T} \int\limits_{t = -\frac{T}{2}}^{\frac{T}{2}} \underline{x}_i(t) \cdot \overline{\underline{x}_i(t+\tau)} \; \mathrm{d} t
\end{equation}
\begin{equation}
	\underline{\mathrm{R}}_{XX}(\tau) \approx \left(x \star x\right)(\tau) = \int\limits_{t = -\infty}^{\infty} \underline{x}_i(t) \cdot \overline{\underline{x}_i(t+\tau)} \; \mathrm{d} t
\end{equation}

\subsubsection{Properties}

\paragraph{Symmetry.}

The autocorrelation function $\underline{\mathrm{R}}_{XX}(\tau)$ is Hermitian.

\begin{equation}
	\underline{\mathrm{R}}_{XX}(\tau) = \overline{\underline{\mathrm{R}}_{XX}(-\tau)}
	\label{eq:ch02:autocorr_hermitian}
\end{equation}

\paragraph{Bounded output.}

For an ergodic or \ac{WSS} process, the autocorrelation function has its maximum at $\underline{\mathrm{R}}_{XX}(0)$.

\begin{equation}
	\left|\underline{\mathrm{R}}_{XX}(\tau)\right| \leq \left|\underline{\mathrm{R}}_{XX}(0)\right|
\end{equation}

\paragraph{Cauchy-Schwarz inequality.}

For all stochastic processes -- even for non-ergodic or non-\acs{WSS} processes:

\begin{equation}
	\left|\underline{\mathrm{R}}_{XX}(t_1, t_2)\right|^2 \leq \E\left\{ \left|\cmplxvect{x}(t_1)\right|^2 \right\} \cdot \E\left\{ \left|\cmplxvect{x}(t_2)\right|^2 \right\}
\end{equation}

\subsection{Energy Spectral Density}

\begin{definition}{Parseval's theorem}
	Given is a time domain function $\underline{x}(t)$ and its Fourier transform $\underline{X}\left(j \omega\right)$. According to the \index{Parseval's theorem} Parseval's theorem:
	\begin{equation}
		\int\limits_{-\infty}^{\infty} \left|\underline{x}(t)\right|^2 \; \mathrm{d} t = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty} \left|\underline{X}\left(j \omega\right)\right|^2 \; \mathrm{d} \omega
	\end{equation}
\end{definition}

Let's remember the signal energy defined in Chapter 2.
\begin{equation}
	E = \int\limits_{-\infty}^{\infty} \left|\underline{x}(t)\right|^2 \; \mathrm{d} t
\end{equation}

Using the Parseval's theorem:
\begin{equation}
	E = \int\limits_{-\infty}^{\infty} \left|\underline{x}(t)\right|^2 \; \mathrm{d} t = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty} \left|\underline{X}\left(j \omega\right)\right|^2 \; \mathrm{d} \omega
	\label{eq:ch03:sig_energy_parseval}
\end{equation}

\begin{itemize}
	\item The total signal energy can be calculated by integrating the squared sum of either the time domain signal or the frequency domain signal.
	\item This is like the \emph{principle of conservation of power} in the signal theory.
\end{itemize}

The definition of the \textbf{energy spectral density} $\mathrm{S}_{E,xx}(\omega)$ can be derived from \eqref{eq:ch03:sig_energy_parseval}.

\begin{definition}{Energy spectral density}
	\begin{equation}
		\mathrm{S}_{E,xx}(\omega) = \frac{1}{2 \pi} \left|\underline{X}\left(j \omega\right)\right|^2
	\end{equation}%
	\nomenclature[Ss]{$\underline{\mathrm{S}}_{E,xx}(\omega)$}{Energy spectral density}
	
	The \index{energy spectral density} \textbf{energy spectral density} is the squared Fourier transform of the time domain signal $\underline{x}(t)$. It is always real-valued.
\end{definition}

The energy spectral density describes how the signal energy is distributed over the frequency.
\begin{equation}
	E = \int\limits_{-\infty}^{\infty} \mathrm{S}_{E,xx}(\omega) \; \mathrm{d} \omega
\end{equation}

\subsection{Power Spectral Density}

\begin{itemize}
	\item The energy spectral density is applicable for energy signals with a finite energy.
	\item We deal with \ac{WSS} (ergodic) processes which are power signals, i.e., their signal energy is infinite.
\end{itemize}

Analogue to the energy spectral density, we will find the \index{power spectral density} \textbf{\ac{PSD}} $\mathrm{S}_{P,xx}(\omega)$ or simply $\mathrm{S}_{xx}(\omega)$. It describes the distribution of the signal power over the frequency. \nomenclature[Ss]{$\mathrm{S}_{xx}(\omega)$, $\mathrm{S}_{P,xx}(\omega)$}{Power spectral density}

\begin{definition}{Wiener-Khinchin theorem}
	The \index{Wiener-Khinchin theorem} Wiener-Khinchin theorem states that the autocorrelation function of a \ac{WSS} process is the inverse Fourier transform of the \index{power spectral density} \textbf{\ac{PSD}}.
	
	\begin{equation}
		\underline{\mathrm{R}}_{XX}(\tau) = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty} \mathrm{S}_{xx}(\omega) e^{j \omega \tau} \; \mathrm{d} \omega = \mathcal{F}^{-1} \left\{\mathrm{S}_{xx}(\omega)\right\}
	\end{equation}
	
	And vice versa,
	\begin{equation}
		\mathrm{S}_{xx}(\omega) = \int\limits_{-\infty}^{\infty} \underline{\mathrm{R}}_{XX}(\tau) e^{-j \omega \tau} \; \mathrm{d} \tau = \mathcal{F}\left\{\underline{\mathrm{R}}_{XX}(\tau)\right\}
		\label{eq:ch03:psd_def}
	\end{equation}
\end{definition}

The \ac{PSD} $\mathrm{S}_{xx}(\omega)$ is always real-valued -- even for a complex-valued signal $\underline{x}(t)$ and its complex-valued autocorrelation function $\underline{\mathrm{R}}_{XX}(\tau)$.
\begin{itemize}
	\item The autocorrelation is Hermitian \eqref{eq:ch02:autocorr_hermitian}.
	\item Due to the symmetry rules, the Fourier transform of a real-valued signal is Hermitian.
	\item Using the duality of the Fourier transform, the Fourier transform of a Hermitian function is real-valued.
	\item Therefore, the \ac{PSD} $\mathrm{S}_{xx}(\omega)$ is real-valued, because it is the Fourier transform of the Hermitian autocorrelation function $\mathrm{R}_{XX}(\tau)$.
\end{itemize}

\begin{excursus}{Unit of the \ac{PSD}}
	The time domain signal is a physical quantity with a unit. The autocorrelation has the square of the unit. Because of \eqref{eq:ch03:psd_def}, the unit of the \ac{PSD} must be the squared unit of the physical quantity divided by seconds.
	
	Example:
	\begin{itemize}
		\item A voltage signal is given in the time domain: $u(t)$.
		\item Its unit is \si{V}.
		\item the unit of the autocorrelation is $\si{V^2}$.
		\item In electrical engineering, the power of a voltage signal depends also on an ohmic resistance $R$, which the voltage is applied to.
		\item Thus, the \ac{PSD} of the voltage signal is divided by $R$. This yields the unit $\si{W/(1/s)}$.
		\item In practice, the real frequency is used in favour of the angular frequency. The unit of $\mathrm{S}_{xx}(f)$ is $\si{W/Hz}$.
	\end{itemize}
	Watt per Hertz makes clear that the power is distributed over the frequency.
\end{excursus}

\subsubsection{Special Case: Real-Valued Signal}

If a signal $x(t)$ is always real-valued:
\begin{itemize}
	\item The autocorrelation function $\mathrm{R}_{XX}(\tau)$ is always real-valued, too.
	\item The autocorrelation function $\mathrm{R}_{XX}(\tau) = \mathrm{R}_{XX}(-\tau)$ is even.
	\item The \ac{PSD} $\mathrm{S}_{xx}(\omega) = \mathrm{S}_{xx}(- \omega)$ is even, too.
\end{itemize}

%TODO
%The Wiener-Khinchin theorem can be simplified:
%\begin{subequations}
%	\begin{align}
%		\mathrm{R}_{XX}(\tau) = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty} \mathrm{S}_{xx}(\omega) e^{j \omega \tau} \; \mathrm{d} \omega \\
%		\mathrm{S}_{xx}(\omega) = \int\limits_{-\infty}^{\infty} \underline{\mathrm{R}}_{XX}(\tau) e^{-j \omega \tau} \; \mathrm{d} \tau
%	\end{align}
%\end{subequations}

\subsubsection{Signal Power}

Let's recall the definition of the signal power.
\begin{equation}
	P = \lim\limits_{T \rightarrow \infty} \frac{1}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} \left|x(t)\right|^2 \; \mathrm{d} t
\end{equation}

The \ac{PSD} $\mathrm{S}_{xx}(\omega)$ defines the density of power. The whole signal power is the integral over the whole spectrum.
\begin{equation}
	P = \int\limits_{-\infty}^{\infty} \mathrm{S}_{xx}(\omega) \; \mathrm{d} \omega
\end{equation}

Consider a special case of the autocorrelation function $\underline{\mathrm{R}}_{XX}(0)$ at a time lag of zero $\tau = 0$.
\begin{equation}
	\underline{\mathrm{R}}_{XX}(0) = \frac{1}{2 \pi} \underbrace{\int\limits_{-\infty}^{\infty} \mathrm{S}_{xx}(\omega) \; \mathrm{d} \omega}_{= P}
\end{equation}

The autocorrelation function $\underline{\mathrm{R}}_{XX}(0)$ at a time lag of zero $\tau = 0$ is the signal power divided by $2 \pi$.
\begin{equation}
	\underline{\mathrm{R}}_{XX}(0) = \frac{1}{2 \pi} P
\end{equation}

\textit{Remark:} $\underline{\mathrm{R}}_{XX}(0)$ is always real-valued because $\underline{\mathrm{R}}_{XX}(\tau)$ is a Hermitian function.

\subsubsection{Signal Power of A Band-Limited, Real-Valued Signal}

The power of all signals is distributes in both positive and negative frequencies.

The power of a certain band $[\omega_1, \omega_2]$ of a real-valued signal contains the power of $[-\omega_2, -\omega_1]$, too.
\begin{equation}
	\begin{split}
		P_{bandlimited} &= \int\limits_{\omega_1}^{\omega_2} \mathrm{S}_{xx}(\omega) \; \mathrm{d} \omega + \int\limits_{-\omega_2}^{-\omega_1} \mathrm{S}_{xx}(\omega) \; \mathrm{d} \omega \\
		 &= 2 \int\limits_{\omega_1}^{\omega_2} \mathrm{S}_{xx}(\omega) \; \mathrm{d} \omega
	\end{split}
\end{equation}

\begin{attention}
	Don't forget do double the ``band-limited integral'' for a real-valued signal.
\end{attention}

\subsubsection{\acs{PSD} of Input and Output of an \acs{LTI} System}

An input signal $\underline{x}(t)$ to an \ac{LTI} system has the autocorrelation function $\underline{\mathrm{R}}_{XX}(\tau)$.
\begin{equation}
	\underline{\mathrm{R}}_{XX}(\tau) \approx \underline{x}(t) \star \underline{x}(t) = \underline{x}(t) * \overline{\underline{x}(-t)}
\end{equation}

The \ac{PSD} is:
\begin{equation}
	\mathrm{S}_{xx}(\omega) = \mathcal{F}\left\{\underline{\mathrm{R}}_{XX}(\tau)\right\} = \underline{X}\left(j \omega\right) \cdot \overline{\underline{X}\left(j \omega\right)} = \left|\underline{X}\left(j \omega\right)\right|^2
\end{equation}

Same applies for the output signal $\underline{y}(t)$:
\begin{equation}
	\mathrm{S}_{yy}(\omega) = \left|\underline{Y}\left(j \omega\right)\right|^2
\end{equation}

$\underline{Y}\left(j \omega\right)$ can be calculated using the transfer function $\underline{H}\left(j \omega\right)$:
\begin{equation}
	\begin{split}
		\underline{Y}\left(j \omega\right) &= \underline{H}\left(j \omega\right) \cdot \underline{X}\left(j \omega\right) \\
		\left|\underline{Y}\left(j \omega\right)\right|^2 &= \left|\underline{H}\left(j \omega\right) \cdot \underline{X}\left(j \omega\right)\right|^2 \\
		\left|\underline{Y}\left(j \omega\right)\right|^2 &= \left|\underline{H}\left(j \omega\right)\right|^2 \cdot \mathrm{S}_{xx}(\omega)
	\end{split}
\end{equation}

The \acp{PSD} of the input and output of an \acs{LTI} system is connected by the square of the transfer function:
\begin{equation}
	\mathrm{S}_{yy}(\omega) = \left|\underline{H}\left(j \omega\right)\right|^2 \cdot \mathrm{S}_{xx}(\omega)
	\label{eq:ch03:psd_lti_io}
\end{equation}

\subsection{Decibel}

After the previous section were very mathematical, let's go back to electrical engineering.

Signal powers in communication system cover a wide range, for example:
\begin{itemize}
	\item Several watts to kilowatts ($10^3$) at the transmitter.
	\item Nanowatt and less ($10^{-9}$) at the receiver.
\end{itemize}
These values are hard to display. Nanowatt would be close to zero when they are depicted in the same plot as the kilowatts. To resolve this issue, logarithmic plots are chosen.

\todo{plot}

But logarithmic expression of signal powers is also common for calculation.
\begin{itemize}
	\item Given that there is an input signal with a power of $P_x = \SI{2}{mW}$.
	\item The signal is amplified by an \ac{LTI} system by a factor of \num{50000}.
	\item The output signal has a power of $P_y = \SI{100000}{mW} = \SI{100}{W}$.
\end{itemize}

Multiplications and numbers with a strongly varying exponent are unhandy. So, they are transformed into the \emph{logarithmic domain}.

\paragraph{Power Quantities.}
A signal with a power quantity $P$ must be referenced to a \emph{reference value} $P_0$. $L_P$ is the \index{power level} \textbf{power level} in reference to $P_0$.
\begin{equation}
	L_P = \SI{10}{dB} \cdot \log_{10} \left(\frac{P}{P_0}\right)
	\label{eq:ch03:level_dbm}
\end{equation}
Vice versa,
\begin{equation}
	P = 10^{\frac{L_P}{\SI{10}{dB}}} \cdot P_0
\end{equation}
The unit of levels is \index{decibel} \textbf{decibel} \si{dB}.

A common reference for powers is $P_0 = \SI{1}{mW}$. So the input signal is $L_{P,x} = \SI{3}{dBm}$. The ``m'' after decibel defines the reference value. \si{dBm} always means that the power level is referenced to $P_0 = \SI{1}{mW}$.

\paragraph{Power Spectral Density.}

If a \ac{PSD} $\mathrm{S}_{xx}(\omega)$ is given, it can be also converted to logarithmic scale using \eqref{eq:ch03:level_dbm} and a reference power $P_0$. The unit is in this case \si{dBm/Hz}.

\paragraph{Ratios.}
The logarithm transform can be applied to ratios of two signal powers. The example system has a gain of $G = 50000$.
\begin{equation}
	G = \frac{P_y}{P_x}
\end{equation}

\begin{equation}
	L_{G,P} = \SI{10}{dB} \cdot \log_{10} \left(G\right) = \SI{10}{dB} \cdot \log_{10} \left(\frac{P_y}{P_x}\right)
\end{equation}

Here, the system gain is \SI{47}{dB}.

\begin{attention}
	Ratios are never referenced to a physical quantity. Their unit is \underline{always \si{dB}}, never \si{dBm} or anything else.
\end{attention}

\paragraph{Operations.}

Using the linear power scale, applying a gain to an input signal is a multiplication. For logarithms, the following applies:
\begin{equation}
	\log \left(a \cdot b\right) = \log a + \log b
\end{equation}

Consequently, the output power level $L_{P,y} = L_{P,x} + L_{G,P} = \SI{50}{dBm}$. The unit \si{dBm} is retained, \si{dB} is just a unit-less ratio. \SI{50}{dBm} can then be transformed back to the linear power scale using the reference power $P_0 = \SI{1}{mW}$. $P_y = \SI{100}{W}$.

\paragraph{Other Physical Quantities.}

Above explanations considered signal powers. However, some signals are given in voltages or currents.

If the voltage is applied to a impedance $R$, the power is
\begin{equation}
	P = \frac{U^2}{R}
\end{equation}

The level is, using the reference $U_0 = \sqrt{P_0 R}$:
\begin{equation}
	\begin{split}
		L_U &= \SI{10}{dB} \cdot \log_{10} \left(\frac{P}{P_0}\right) \\
		 &= \SI{10}{dB} \cdot \log_{10} \left(\frac{U^2}{R} \cdot \frac{R}{U_0^2}\right) \\
		 &= \SI{10}{dB} \cdot \log_{10} \left(\left(\frac{U}{U_0}\right)^2\right) \\
		 &= \SI{20}{dB} \cdot \log_{10} \left(\frac{U}{U_0}\right) \\
	\end{split}
\end{equation}

Same applies for currents.

So, pure powers have a factor of $\SI{10}{dB}$ and current and voltage signals $\SI{20}{dB}$.

\paragraph{Different Reference Levels.}

The logarithmic scale is used for various physical quantities. The table below shows common values, using in communication systems.

\begin{table}[H]
	\centering
	\caption{Common reference levels and the corresponding unit}
	\begin{tabular}{|r|l|l|}
		\hline
		Reference level $P_0$, $U_0$, $I_0$, ... & Unit & Description \\
		\hline
		\hline
		n/a & \si{dB} & Relative \\
		\hline
		\SI{1}{mW} & \si{dBm} & Power \\
		\hline
		\SI{1}{W} & \si{dBW} & Power \\
		\hline
		\SI{1}{V} & \si{dBV} & Voltage \\
		\hline
		\SI{1}{\micro.V} & \si{dB\micro.V} & Voltage \\
		\hline
		Power of carrier signal & \si{dBc} & Relative to carrier \\
		\hline
	\end{tabular}
\end{table}

\section{Noise}

\subsection{Types of Noise}

\subsection{Thermal Noise}

\subsection{White Noise}

\subsection{Noise Floor and Noise Figure}

\phantomsection
\addcontentsline{toc}{section}{References}
\printbibliography[heading=subbibliography]
\end{refsection}

